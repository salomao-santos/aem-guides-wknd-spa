# This workflow mirrors the code to the wknd.site repository
name: Deploy to WKND.site Production
env:
  # Target repository
  TARGET_REPO: ${{ secrets.WKND_REPOSITORY }}
  TARGET_BRANCH_DEV: ${{ secrets.WKND_BRANCH_DEV }}
  TARGET_BRANCH_PROD: ${{ secrets.WKND_BRANCH_PROD }}
  USER_EMAIL: ${{ secrets.WKND_USER_EMAIL }}
  USER_NAME: ${{ secrets.WKND_USER_NAME }}
  USER_PWD: ${{ secrets.WKND_PASSWORD }}

# Only run on a push to master branch
on:
  push:
    branches: [ master ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ ubuntu-20.04, macos-latest, windows-latest ]
        java: [11]
        profile: [ '']

    steps: 
       - name: Configure git with longpath enabled (for windows)
        run: git config --global core.longpaths true
      # Check out Git repository
      - name: Checkout code
        uses: actions/checkout@v2


# Set up environment with Java and Maven Antes
       - name: Setup JDK
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin'
          java-version: 8
          cache: maven


# Set up environment with Java and Maven Depois
      - name: Setup JDK
        uses: actions/setup-java@v1
        with:
          java-version: ${{ matrix.java }}

# Set up dependency cache
     uses: actions/cache@v2 por
    uses: actions/cache@v3


# Build & Test
    run:  mvn clean install ${{ matrix.profile }} por
    run:  mvn clean install